<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tower Defense Game</title>
  <link rel="stylesheet" href="index.css">

</head>
<body>
  <div id="wrapper">
    <header id="header">
      Tower Defense Game
    </header>
    <img id="turret" src="images/turret.png" alt="Turret">
    <h4 id="message">This tower defense game is designed to push your strategic skills to the limit. It's OK to lose some health at the start, you'll get them back eventually!</h4>

    <div id="popup" class="popup">
      <div class="popup-header">
        <button class="tab-button active" onclick="showTab('tutorial')">Tutorial</button>
        <button class="tab-button" onclick="showTab('stats')">Stats</button>
        <button class="tab-button" onclick="showTab('enemies')">Enemies</button>
        <button class="tab-button" onclick="showTab('tips')">Tips</button>
        <button class="close-popup" onclick="closePopup()">Ã—</button>
      </div>
      <div class="popup-content">
        <div id="tutorial" class="tab-content active">
          <h1>Tutorial</h1>
          <h3>Place Turrets:</h3>
          <ul>
            <li>Click <strong>"Buy Turret"</strong> to purchase a turret (requires money).</li>
            <li>Place the turret on valid spots in the game area (strategic placement is key).</li>
            <li>Drag to the garbage bin to cancel turret selection.</li>
          </ul>
          <h3>Upgrade Turrets:</h3>
          <ul>
            <li>Select a turret and click <strong>"Upgrade"</strong> to enhance its stats.</li>
            <li>Each upgrade increases damage, range, shooting speed, and sometimes projectile speed.</li>
            <li>Check <strong>"Stats"</strong> tab for more information.</li>
          </ul>
          <h3>Switch Target Modes:</h3>
          <p>Use arrow keys or the <strong>"Change Target Mode"</strong> button to switch turret targeting modes:</p>
          <ul>
            <li>Mode 0: Targets the closest enemy.</li>
            <li>Mode 1: Targets the strongest enemy.</li>
            <li>Mode 2: Targets the first/furthest enemy.</li>
            <li>Mode 3: Targets the last enemy.</li>
          </ul>
          <h3>Waves:</h3>
          <p>Click <strong>"Start Wave"</strong> when the wave is ready. Defeat enemies before they reach the end of the path.</p>
          </ul>
            <li><strong>*NEW*:</strong> Waves will <strong>auto start</strong> by default when "Start Wave" is clicked. You can disable this by clicking the button again while wave is active.</li>
            <li><strong>Boss waves</strong> occur every <strong>8</strong> waves. There are less enemies but they are much stronger and require more strategic planning.</li>
          </ul>
          <h3>Adjust Game Speed:</h3>
          <p>Use the <strong>"Toggle Speed"</strong> button to switch between 1x, 1.5x, and 2x speed. (There is a slight cooldown)</p>
          <h3>Important things to note:</h3>
          </ul>
            <li>You start with $1200. It increases by $150 every wave.</li>
            <li>Your health starts at 100 and increases by an increasing amount every wave so it's OK to lose some health. The game is over when health reaches 0.</li>
            <li>Turret prices increases with each turret bought.</li>
          <h2>Good luck and have fun!</h2>
        </div>
    
        <div id="stats" class="tab-content">
          <h1>Stats</h1>
          <div id="stats-sections"></div> 
          <br>
          <p>*Shoot cooldown is in Frames. The FPS is set to 60 for this game.</p>
        </div>
               
        <div id="enemies" class="tab-content">
          <h1>Enemies</h1>
          <div id="enemies-container" class="enemies-container">
          </div>
        </div>
        
        <div id="tips" class="tab-content">
          <h1>Tips</h1>
        
          <h3>Placement</h3>
          <ul>
            <li>
              <strong>Take projectile speed into account!</strong> (Except snipers cuz they are just too good.)
            </li>
            <li>
              Place turrets near paths to increase the chance of hitting enemies.
              <ul>
                <p>
                  <strong>Example of bad shooter placement:</strong>
                  <button class="dropdown-toggle" onclick="toggleDropdown('bad-placement')">Show/Hide Example</button>
                  <div id="bad-placement" class="dropdown-content">
                    <img src="images/badPlacement.jpeg" alt="Bad Placement Example" class="tip-image">
                  </div>
                </p>
              </ul>
            </li>
            <li>
              The more path coverage a turret has, the better.
            </li>
            <li>
              Turrets with special abilities may benefit from strategic placement:
              <ul>
                <p>
                  <strong>Example of ideal wizard placement:</strong>
                  <button class="dropdown-toggle" onclick="toggleDropdown('wizard-placement')">Show/Hide Example</button>
                  <div id="wizard-placement" class="dropdown-content">
                    <img src="images/wizardPlacement.jpeg" alt="Wizard Placement Example" class="tip-image">
                  </div>
                </p>
              </ul>
            </li>
          </ul>
        
          
          
        
          <h3>Target Modes</h3>
          <ul>
            <li>Target modes are critical for maximizing turret efficiency.</li>
            <li>Adjust target modes based on turret type and placement:
              <ul>
                <li>Snipers are best set to "Strong" to maximize their heavy damage. Alternatively, use "First" for general defense.</li>
                <li><strong>Wizards should almost ALWAYS be set to "Last"</strong> when placed at the end of a straight path. This ensures their piercing ability is fully utilized.</li>
              </ul>
            </li>
          </ul>
        
          <h3>Other Tips</h3>
          <ul>
            <li>Focus on upgrades rather than adding more turrets. Upgrading is often the better choice when it costs less.</li>
            <li>Selling a turret gives back <strong>90%</strong> of all money spent on the turret and reverts the buying cost to the previous one.</li>
            <li>Use a mix of turrets to cover weaknesses:
              <ul>
                <li>Shooter turrets: All-rounders but don't excel in any area.</li>
                <li>Snipers: Great for single-target damage and boss waves due to their range and power.</li>
                <li>Wizards: Reduce health of multiple enemies at once but are less effective against bosses.</li>
              </ul>
            </li>
          </ul>
          
        </div>
        
      </div>
    </div>
    
    
    <button id="openTutorialButton" onclick="toggleTutorialPopup()">
      <img src="images/tutorial.png" alt="Tutorial Icon" class="tutorialIcon">Tutorial
    </button>
    
    <div id="container">
      <div id="gameCanvas">

        
      </div>
      <img id="garbage" src="images/garbage.png" alt="Garbage Can">
      
          <div id="turretInfo" class="turret-info">
            <button id="sellButton">Sell</button>
            <h3 id="turretDetailsHeader">Turret Details</h3>
            
            <div class="info-container">
              <div id="turretCurrentStats">
                Level: 2<br>
                Range: 150<br>
                Damage: 30<br>
                Cooldown: 5s
              </div>
              
              <div id="turretNextStats">
                Next Level:<br>
                Range: 180<br>
                Damage: 35<br>
                Cooldown: 4s
              </div>
              
              <div class="upgrade-section">
                <button id="upgradeButton" class="blue">Upgrade</button>
              </div>
            </div>
          </div>

      <div id="gameMenu">
        <div id="menuInfo">
          <div title="Money">
            <img src="images/money.png" alt="Money Icon">
            <h2 id="Money">100</h2>
          </div>
          <div title="Health">
            <img src="images/health.png" alt="Health Icon">
            <h2 id="Health">100</h2>
          </div>
          <div title="Wave">
            <img src="images/wave.png" alt="Wave Icon">
            <h2 id="Wave">0</h2>
          </div>
        </div>
        <div id="menuButtons">
          
          <button class="hoverButton" id="buyText" onclick="showTurretMenu()">
            Buy a Turret
            <span class="hoverText" id="buyTurretText">Select a turret to buy</span>
          </button>

          <div id="turretMenu" class="popupMenu" style="display: none;">
            <button onclick="buyTurret('shooter')">
              <span>Buy Shooter - $150</span>
              <img src="images/shooter_icon.png" alt="Shooter Icon">
            </button>
            <button onclick="buyTurret('sniper')">
              <span>Buy Sniper - $300</span>
              <img src="images/sniper_icon.png" alt="Sniper Icon">
            </button>
            <button onclick="buyTurret('wizard')">
              <span>Buy Wizard - $400</span>
              <img src="images/orb.png" alt="Orb Icon">
            </button>
            <button onclick="buyTurret('froster')">
              <span>Buy Froster - $350</span>
              <img src="images/freezegun.png" alt="Freeze Gun">
            </button>          
          </div>
          

          <button id="startWaveButton" class="hoverButton" onclick="toggleAutoStart()" onmouseover="checkWave()">
            Start Wave 
            <span class="autoStartToggle">Auto Start Toggle: False</span>
            <span class="hoverText" id="waveText">Wave Ready</span>
          </button>

          <button class="hoverButton" onclick="toggleSpeed()" onmouseover="checkSpeed()">
            Toggle Speed
            <span class="hoverText" id="speedText">Current Speed: 1x</span>
          </button>
          <button class="hoverButton" onclick="changeTargetMode()" onmouseover="checkTargetMode()">
            Change Target Mode
            <span class="hoverText" id="targetModeText">Mode: 0 (Closest)</span>
          </button>
        </div>
        <div id="healthPopup" class="popupMessage">+ x Health</div>
        <div id="moneypopup" class="popupMessage">+ x $</div>
        <div id="bossWarningPopup" class="popupMessage">Boss Wave Incoming!</div>
      </div>
    </div>
    <br
  </div>


  <footer id="footer">
    A project by <a href="https://github.com/changkevin51" target="_blank" style="color: #ffffff; text-decoration: underline;">Kevin Chang</a>
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"></script>
  <script src="path.js"></script>
  <script src="enemy.js"></script>
  <script src="turret.js"></script>
  <script src="projectile.js"></script>
  <script src="wave.js"></script>
  <script src="index.js" defer></script>
  <script src="tutorial.js" defer></script>
</body>
</html>